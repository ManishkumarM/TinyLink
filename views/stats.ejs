<!DOCTYPE html>
<html>
<head>
    <title>TinyLink — Stats</title>
    <link rel="stylesheet" href="/styles.css">
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
    <script src="/js/main.js" defer></script>
</head>

<body>

<div class="container my-5">

    <a href="/" class="btn btn-outline-secondary mb-4">← Back to Dashboard</a>

    <% if (notFound) { %>
        <div class="alert alert-danger">
            The requested short code does not exist or has been deleted.
        </div>
    <% } else { %>

    <div class="card p-4 shadow-sm mb-4">

        <h2 class="mb-3">Stats for <strong>/<%= link.short_code %></strong></h2>

        <p class="text-muted">Details about this TinyLink</p>

        <div class="row mt-4">

            <div class="col-md-6">
                <h5>Short URL</h5>
                <div class="input-group mb-3">
                    <input id="shortURL" class="form-control"
                           value="<%= baseURL %>/<%= link.short_code %>" readonly>
                    <button class="btn btn-primary" onclick="copyShortURL()">Copy</button>
                </div>

                <h5>Original URL</h5>
                <p class="text-break"><%= link.original_url %></p>

                <h5>Created At</h5>
                <p><%= link.created_at.toLocaleString() %></p>

                <h5>Last Click</h5>
                <p>
                    <%= link.updated_at ? link.updated_at.toLocaleString() : "Never clicked" %>
                </p>

                <h5>Total Clicks</h5>
                <p class="fs-3"><%= link.clicks %></p>
            </div>

            <div class="col-md-6 text-center">
                <h5>QR Code</h5>
                <img src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=<%= baseURL %>/<%= link.short_code %>"
                     class="shadow-sm rounded">
            </div>

        </div>

    </div>

    <% } %>

</div>

</body>
</html>
